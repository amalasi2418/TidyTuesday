fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_fill_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
scale_fill_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_fill_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
scale_fill_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
bg = "#F5F7B2"
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
scale_color_gradientn(colours = c("#1CC5DC","#890596","#CF0000"))+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
scale_color_gradientn(colours = c("#1CC5DC","#890596","#CF0000"),direction=-1)+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"))+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
bg ="#FEFFDE"
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
bg = "#FF4848"
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"))+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
bg="#809A6F"
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant8.png", fig, width = 10, height = 10, units = "in")
ggsave("pell_grant_x.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
strip.text = element_blank())
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
library(showtext)
text="Palatino"
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =40),
plot.caption = element_text(size=20),
strip.text = element_blank(),
text = element_text(family = text))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
showtext_auto()
sysfonts::font_families_google()
sysfonts::font_add_google(text,text)
text="Overpass"
sysfonts::font_add_google(text,text)
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =40),
plot.caption = element_text(size=20),
strip.text = element_blank(),
text = element_text(family = text))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, hjust = 0),
plot.caption = element_text(size=30),
strip.text = element_blank(),
text = element_text(family = text))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, hjust = -0.5),
plot.caption = element_text(size=30),
strip.text = element_blank(),
text = element_text(family = text))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, hjust = 0.5),
plot.caption = element_text(size=30),
strip.text = element_blank(),
text = element_text(family = text))
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, hjust = 0.5),
plot.caption = element_text(size=30),
strip.text = element_blank(),
plot.margin = margin(t=10,b=10,r=10,l=10),
text = element_text(family = text))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, hjust = 0.5,margin = margin(b=10)),
plot.caption = element_text(size=30),
strip.text = element_blank(),
plot.margin = margin(t=10,b=10,r=10,l=10),
text = element_text(family = text,color="#252525"))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "y") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, face = "bold",hjust = 0.5,margin = margin(t=10,b=10)),
plot.caption = element_text(size=30),
strip.text = element_blank(),
plot.margin = margin(t=10,b=10,r=10,l=10),
text = element_text(family = text,color="#252525"))
ggsave("pell_grant_y.png", fig, width = 10, height = 10, units = "in")
fig <- pell %>%
ggplot(aes(YEAR,RECIPIENT, size=AWARD, color=(AWARD))) +
geom_line() +
labs(title = "Pell grants are beautiful",
caption = "Data: US Dept. of Education | Graphic: Abhinav Malasi") +
scale_y_log10()+
coord_polar(theta = "x") +
theme_void() +
theme(legend.position = "none") +
#scale_color_gradientn(colours = c("#04009A","#77ACF1","#3EDBF0"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#FFD371","#C2FFD9","#9DDAC6"))+
#scale_color_gradientn(colours = c("#CF0000","#890596","#1CC5DC"),trans="pseudo_log")+
#scale_color_gradientn(colours = c("#52734D","#91C788","#DDFFBC"),trans="pseudo_log")+
scale_color_gradientn(colours = c("#A25B5B","#CC9C75","#D5D8B5"),trans="pseudo_log")+
facet_wrap(~STATE, ncol = 8)+
theme(plot.background = element_rect(fill=bg,color=bg),
panel.background = element_rect(fill=bg,color=bg),
plot.title = element_text(size =80, face = "bold",hjust = 0.5,margin = margin(t=10,b=10)),
plot.caption = element_text(size=30),
strip.text = element_blank(),
plot.margin = margin(t=10,b=10,r=10,l=10),
text = element_text(family = text,color="#252525"))
ggsave("pell_grant_x.png", fig, width = 10, height = 10, units = "in")
library(tidyverse)
library(wesanderson)
# This function creates the segments of the original polygon
polygon <- function(n) {
tibble(
x    = accumulate(1:(n-1), ~.x+cos(.y*2*pi/n), .init = 0),
y    = accumulate(1:(n-1), ~.x-sin(.y*2*pi/n), .init = 0),
xend = accumulate(2:n,     ~.x-cos(.y*2*pi/n), .init = cos(2*pi/n)),
yend = accumulate(2:n,     ~.x+sin(.y*2*pi/n), .init = sin(2*pi/n)))
}
# This function creates segments from some mid-point of the edges
mid_points <- function(d, p, a, i, FUN = ratio_f) {
d %>% mutate(
angle=atan2(yend-y, xend-x) + a,
radius=FUN(i),
x=p*x+(1-p)*xend,
y=p*y+(1-p)*yend,
xend=x+radius*cos(angle),
yend=y+radius*sin(angle)) %>%
select(x, y, xend, yend)
}
# This function connect the ending points of mid-segments
con_points <- function(d) {
d %>% mutate(
x=xend,
y=yend,
xend=lead(x, default=first(x)),
yend=lead(y, default=first(y))) %>%
select(x, y, xend, yend)
}
edges <- 4   # Number of edges of the original polygon
niter <- 250 # Number of iterations
pond <- 0.3  # Weight to calculate the point on the middle of each edge
step  <- 10  # No of times to draw mid-segments before connect ending points
alph  <- 0.25 # transparency of curves in geom_curve
angle <- 0.6 # angle of mid-segment with the edge
curv <- 0.1   # Curvature of curves
line_color <- "white" # Color of curves in geom_curve
back_color <- "black" # Background of the ggplot
ratio_f <- function(x) {sin(x)} # To calculate the longitude of mid-segments
# Generation on the fly of the dataset
accumulate(.f = function(old, y) {
if (y%%step!=0) mid_points(old, pond, angle, y) else con_points(old)
}, 1:niter,
.init=polygon(edges)) %>% bind_rows() -> df
ggplot(df)+
geom_curve(aes(x=x, y=y, xend=xend, yend=yend),
curvature = curv,
size=.1,
color=line_color,
alpha=alph
)+
# ggforce::geom_voronoi_tile(aes(x-y,y+x,
#
#                                fill= ratio_f(x+y),
#                                alpha=ratio_f(y)^2+ratio_f(x)^2,
#                                size=abs(ratio_f(x))),
#                            #fill="#FFD371",
#                                #color="#FF4848",
#                                #alpha=alph,
#                                #radius = unit(1.5, 'mm')
#                                max.radius = 0.2
#                                )+
#ggforce::geom_voronoi_segment(aes(x,y))+
coord_equal()+
ggplot2::scale_fill_gradientn(colours = pal) +
theme(legend.position  = "none",
panel.background = element_rect(fill=back_color,color=back_color),
plot.background  = element_rect(fill=back_color,color=back_color),
axis.ticks       = element_blank(),
panel.grid       = element_blank(),
axis.title       = element_blank(),
axis.text        = element_blank())
pal <- wes_palette("Zissou1", 100, type = "continuous")
pal <- wes_palette("Chevalier1", 100, type = "continuous")
# Generation on the fly of the dataset
accumulate(.f = function(old, y) {
if (y%%step!=0) mid_points(old, pond, angle, y) else con_points(old)
}, 1:niter,
.init=polygon(edges)) %>% bind_rows() -> df
ratio_f <- function(x) {sin(x)} # To calculate the longitude of mid-segments
# Generation on the fly of the dataset
accumulate(.f = function(old, y) {
if (y%%step!=0) mid_points(old, pond, angle, y) else con_points(old)
}, 1:niter,
.init=polygon(edges)) %>% bind_rows() -> df
